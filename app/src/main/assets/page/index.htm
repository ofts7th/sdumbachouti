<div class="cs_page fullfill cscontainer" id="page_asset_index">
    <div class="row pageheader flexcontainer">
        <div class="flex1"></div>
        <div class="flex4 aligncenter">
            <span>MBA面试</span>
        </div>
        <div class="flex1">
            <div class="floatright assetpagelink" style="padding-right: 1rem;" data-url="config.htm">
                <span class="glyphicon glyphicon-list"></span>
            </div>
        </div>
    </div>
    <div class="message" style="display: none;padding: 2rem;"></div>
    <div class="pnlChouTi">
        <div style="margin: 1rem;text-align: center;">请点击开始按钮进行抽题</div>
        <div style="margin: 1rem;text-align: center;">
            <div class="startChouTi btn btn-default" style="font-size: 2rem; padding: 2rem 5rem;">开始</div>
        </div>
        <div class="timuGundong"
             style="margin: 1rem; text-align: center;font-size: 3rem;display: none;"></div>
        <div style="margin: 1rem;" class="myTiMu"></div>
    </div>
    <script>
        var tiShu = 0;
        var chouTiGunDongEle = $('#page_asset_index .timuGundong');

        $(function(){
            var pageEle = $('#page_asset_index');

            var step = 0;
            var chouTiInterval = null;

            tiShu = local.getTiMuCount();
            if(tiShu == 0){
                pageEle.find('.message').html('尚未指定数据文件');
                pageEle.find('.message').show();
                pageEle.find('.pnlChouTi').hide();
                return;
            }
            pageEle.find('.startChouTi').click(function(){
                var self = $(this);
                switch(step){
                    case 0:
                        self.html('停止');
                        chouTiGunDongEle.html('');
                        chouTiGunDongEle.show();
                        chouTiInterval = setInterval(chouTi, 200);
                        break;
                    case 1:
                        self.html('清空');
                        if(chouTiInterval){
                            chouTiGunDongEle.hide();
                            clearInterval(chouTiInterval);
                            chouTiInterval = null;
                        }

                        var ele = pageEle.find('.myTiMu');
                        ele.empty();
                        var arr_timu = chouTiGunDongEle.data('timu').split(',');
                        arr_timu.forEach((item, idx, arr)=>{
                            var e = $('<div style="margin: 1rem;"></div>');
                            e.html('题目' + item + "<br />" + local.getTiMu(parseInt(item)));
                            ele.append(e);
                        });
                        ele.show();
                        break;
                    case 2:
                        self.html('开始');
                        pageEle.find('.myTiMu').hide();
                        step = -1;
                        break;
                }
                step++;
            });
        });

        function chouTi(){
            var i = getRandom(tiShu);
            var j = getRandomWithEx(tiShu, i);
            chouTiGunDongEle.data('timu', i.toString() + "," + j.toString());
            chouTiGunDongEle.html(i.toString() + "，&nbsp;&nbsp;&nbsp;" + j.toString());
        }

        function getRandom(maxNumber){
            var i = Math.round(Math.random()*maxNumber);
            if( i == 0){
                i = maxNumber;
            }
            return i;
        }

        function getRandomWithEx(maxNumber, ex){
            var i = getRandom(maxNumber);
            while(i == ex){
                i = getRandom(maxNumber);
            }
            return i;
        }
    </script>
</div>
